<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>التنبيهات الذكية - Quick Link System</title>
    
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="assets/css/bootstrap.min.css">
    <link rel="stylesheet" href="assets/css/bootstrap.rtl.min.css">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Custom CSS -->
    <link rel="stylesheet" href="assets/css/custom.css">
</head>
<body>
    <!-- Header -->
    <div id="header-placeholder"></div>

    <!-- Sidebar -->
    <div id="sidebar-placeholder"></div>

    <!-- Main Content -->
    <div class="main-content-wrapper">
        <main class="main-content">
            <!-- رأس الصفحة -->
            <div class="d-flex justify-content-between align-items-center mb-4">
                <div>
                    <h2 class="page-title mb-2">
                        <i class="fas fa-bell text-primary me-2"></i>
                        إدارة التنبيهات الذكية
                    </h2>
                    <p class="page-subtitle text-muted">إنشاء وإدارة التنبيهات التلقائية في النظام</p>
                </div>
                <div>
                    <a href="settings.html" class="btn btn-outline-secondary">
                        <i class="fas fa-arrow-right me-1"></i>
                        رجوع للإعدادات
                    </a>
                </div>
            </div>

            <!-- معلومات مهمة -->
            <div class="alert alert-info mb-4">
                <i class="fas fa-lightbulb me-2"></i>
                <strong>التنبيهات الذكية:</strong> يمكنك إنشاء تنبيهات تلقائية لمتابعة الأحداث المهمة في النظام مثل الطلبات المتأخرة، أعياد الميلاد، التعارضات، والنسخ الاحتياطي.
            </div>

            <!-- إحصائيات التنبيهات -->
            <div class="row mb-4">
                <div class="col-md-3 col-6 mb-3">
                    <div class="card stats-card">
                        <div class="card-body text-center">
                            <i class="fas fa-bell-on icon-large text-success"></i>
                            <div class="stats-number">12</div>
                            <div class="stats-label">تنبيهات نشطة</div>
                        </div>
                    </div>
                </div>
                <div class="col-md-3 col-6 mb-3">
                    <div class="card stats-card">
                        <div class="card-body text-center">
                            <i class="fas fa-bell-slash icon-large text-secondary"></i>
                            <div class="stats-number">5</div>
                            <div class="stats-label">تنبيهات معطلة</div>
                        </div>
                    </div>
                </div>
                <div class="col-md-3 col-6 mb-3">
                    <div class="card stats-card">
                        <div class="card-body text-center">
                            <i class="fas fa-paper-plane icon-large text-primary"></i>
                            <div class="stats-number">156</div>
                            <div class="stats-label">إرسال اليوم</div>
                        </div>
                    </div>
                </div>
                <div class="col-md-3 col-6 mb-3">
                    <div class="card stats-card">
                        <div class="card-body text-center">
                            <i class="fas fa-history icon-large text-warning"></i>
                            <div class="stats-number">2,345</div>
                            <div class="stats-label">إجمالي الإرسال</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- إنشاء تنبيه جديد -->
            <div class="card mb-4">
                <div class="card-header">
                    <h5 class="mb-0">
                        <i class="fas fa-plus-circle text-primary me-2"></i>
                        إنشاء تنبيه ذكي جديد
                    </h5>
                </div>
                <div class="card-body">
                    <form id="alertForm" onsubmit="return createAlert(event)">
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label class="form-label">اسم التنبيه <span class="text-danger">*</span></label>
                                <input type="text" class="form-control" id="alertName" placeholder="مثال: طلبات متأخرة" required>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label class="form-label">نوع التنبيه <span class="text-danger">*</span></label>
                                <select class="form-control" id="alertType" required onchange="updateAlertConditions()">
                                    <option value="">اختر نوع التنبيه</option>
                                    <option value="overdue">طلبات متأخرة</option>
                                    <option value="birthday">أعياد ميلاد العملاء</option>
                                    <option value="conflict">تعارضات الهوية</option>
                                    <option value="backup">النسخ الاحتياطي</option>
                                    <option value="payment">مدفوعات معلقة</option>
                                    <option value="documents">مستندات ناقصة</option>
                                    <option value="approval">طلبات تحتاج موافقة</option>
                                    <option value="custom">تنبيه مخصص</option>
                                </select>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label class="form-label">الشرط <span class="text-danger">*</span></label>
                                <select class="form-control" id="alertCondition" required>
                                    <option value="">اختر الشرط</option>
                                    <option value="equal">يساوي</option>
                                    <option value="greater">أكبر من</option>
                                    <option value="less">أقل من</option>
                                    <option value="between">بين</option>
                                    <option value="contains">يحتوي على</option>
                                </select>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label class="form-label">القيمة</label>
                                <input type="text" class="form-control" id="alertValue" placeholder="مثال: 24 ساعة">
                            </div>
                            <div class="col-md-6 mb-3">
                                <label class="form-label">المدة / التكرار <span class="text-danger">*</span></label>
                                <select class="form-control" id="alertFrequency" required>
                                    <option value="realtime">فوري (عند الحدث)</option>
                                    <option value="hourly">كل ساعة</option>
                                    <option value="daily">يومياً</option>
                                    <option value="weekly">أسبوعياً</option>
                                    <option value="monthly">شهرياً</option>
                                </select>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label class="form-label">الأولوية</label>
                                <select class="form-control" id="alertPriority">
                                    <option value="low">منخفضة</option>
                                    <option value="medium" selected>متوسطة</option>
                                    <option value="high">عالية</option>
                                    <option value="critical">حرجة</option>
                                </select>
                            </div>
                            <div class="col-md-12 mb-3">
                                <label class="form-label">المستلمون</label>
                                <div class="row">
                                    <div class="col-md-3">
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" id="notifyAdmin" checked>
                                            <label class="form-check-label" for="notifyAdmin">المدراء</label>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" id="notifyReviewer">
                                            <label class="form-check-label" for="notifyReviewer">المراجعين</label>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" id="notifyIntake">
                                            <label class="form-check-label" for="notifyIntake">جامعي البيانات</label>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" id="notifyEmail">
                                            <label class="form-check-label" for="notifyEmail">إرسال بالبريد</label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-12 mb-3">
                                <label class="form-label">رسالة التنبيه</label>
                                <textarea class="form-control" id="alertMessage" rows="3" placeholder="اكتب رسالة التنبيه المخصصة..."></textarea>
                                <div class="form-text">استخدم {name}, {date}, {time} للقيم الديناميكية</div>
                            </div>
                            <div class="col-md-12">
                                <button type="submit" class="btn btn-success">
                                    <i class="fas fa-save me-1"></i>
                                    إنشاء التنبيه
                                </button>
                                <button type="reset" class="btn btn-outline-secondary">
                                    <i class="fas fa-times me-1"></i>
                                    إلغاء
                                </button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>

            <!-- قائمة التنبيهات الحالية -->
            <div class="card">
                <div class="card-header d-flex justify-content-between align-items-center">
                    <h5 class="mb-0">
                        <i class="fas fa-list text-primary me-2"></i>
                        التنبيهات المُفعّلة حالياً
                    </h5>
                    <div>
                        <button class="btn btn-sm btn-outline-success" onclick="enableAllAlerts()">
                            <i class="fas fa-check-double me-1"></i>
                            تفعيل الكل
                        </button>
                        <button class="btn btn-sm btn-outline-danger" onclick="disableAllAlerts()">
                            <i class="fas fa-ban me-1"></i>
                            تعطيل الكل
                        </button>
                    </div>
                </div>
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table table-hover" id="alertsTable">
                            <thead>
                                <tr>
                                    <th>اسم التنبيه</th>
                                    <th>النوع</th>
                                    <th>الشرط</th>
                                    <th>التكرار</th>
                                    <th>الأولوية</th>
                                    <th>آخر إرسال</th>
                                    <th>الحالة</th>
                                    <th>الإجراءات</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- تنبيه 1 -->
                                <tr>
                                    <td><strong>طلبات متأخرة أكثر من يوم</strong></td>
                                    <td><span class="badge bg-danger">طلبات متأخرة</span></td>
                                    <td>أكبر من 24 ساعة</td>
                                    <td>كل ساعة</td>
                                    <td><span class="badge bg-danger">حرجة</span></td>
                                    <td>2025-01-15 14:00</td>
                                    <td>
                                        <div class="form-check form-switch">
                                            <input class="form-check-input" type="checkbox" id="alert1" checked>
                                            <label class="form-check-label" for="alert1">مُفعّل</label>
                                        </div>
                                    </td>
                                    <td>
                                        <div class="btn-group" role="group">
                                            <button class="btn btn-sm btn-outline-primary" onclick="editAlert(1)" title="تعديل">
                                                <i class="fas fa-edit"></i>
                                            </button>
                                            <button class="btn btn-sm btn-outline-info" onclick="testAlert(1)" title="اختبار">
                                                <i class="fas fa-vial"></i>
                                            </button>
                                            <button class="btn btn-sm btn-outline-danger" onclick="deleteAlert(1)" title="حذف">
                                                <i class="fas fa-trash"></i>
                                            </button>
                                        </div>
                                    </td>
                                </tr>

                                <!-- تنبيه 2 -->
                                <tr>
                                    <td><strong>أعياد ميلاد العملاء</strong></td>
                                    <td><span class="badge bg-warning">أعياد ميلاد</span></td>
                                    <td>قبل 3 أيام</td>
                                    <td>يومياً</td>
                                    <td><span class="badge bg-info">متوسطة</span></td>
                                    <td>2025-01-15 02:00</td>
                                    <td>
                                        <div class="form-check form-switch">
                                            <input class="form-check-input" type="checkbox" id="alert2" checked>
                                            <label class="form-check-label" for="alert2">مُفعّل</label>
                                        </div>
                                    </td>
                                    <td>
                                        <div class="btn-group" role="group">
                                            <button class="btn btn-sm btn-outline-primary" onclick="editAlert(2)" title="تعديل">
                                                <i class="fas fa-edit"></i>
                                            </button>
                                            <button class="btn btn-sm btn-outline-info" onclick="testAlert(2)" title="اختبار">
                                                <i class="fas fa-vial"></i>
                                            </button>
                                            <button class="btn btn-sm btn-outline-danger" onclick="deleteAlert(2)" title="حذف">
                                                <i class="fas fa-trash"></i>
                                            </button>
                                        </div>
                                    </td>
                                </tr>

                                <!-- تنبيه 3 -->
                                <tr>
                                    <td><strong>تعارضات الهوية الجديدة</strong></td>
                                    <td><span class="badge bg-danger">تعارضات</span></td>
                                    <td>عند الاكتشاف</td>
                                    <td>فوري</td>
                                    <td><span class="badge bg-danger">حرجة</span></td>
                                    <td>2025-01-14 11:30</td>
                                    <td>
                                        <div class="form-check form-switch">
                                            <input class="form-check-input" type="checkbox" id="alert3" checked>
                                            <label class="form-check-label" for="alert3">مُفعّل</label>
                                        </div>
                                    </td>
                                    <td>
                                        <div class="btn-group" role="group">
                                            <button class="btn btn-sm btn-outline-primary" onclick="editAlert(3)" title="تعديل">
                                                <i class="fas fa-edit"></i>
                                            </button>
                                            <button class="btn btn-sm btn-outline-info" onclick="testAlert(3)" title="اختبار">
                                                <i class="fas fa-vial"></i>
                                            </button>
                                            <button class="btn btn-sm btn-outline-danger" onclick="deleteAlert(3)" title="حذف">
                                                <i class="fas fa-trash"></i>
                                            </button>
                                        </div>
                                    </td>
                                </tr>

                                <!-- تنبيه 4 -->
                                <tr>
                                    <td><strong>حالة النسخ الاحتياطي</strong></td>
                                    <td><span class="badge bg-success">نسخ احتياطي</span></td>
                                    <td>بعد كل عملية</td>
                                    <td>يومياً</td>
                                    <td><span class="badge bg-warning">عالية</span></td>
                                    <td>2025-01-15 02:05</td>
                                    <td>
                                        <div class="form-check form-switch">
                                            <input class="form-check-input" type="checkbox" id="alert4" checked>
                                            <label class="form-check-label" for="alert4">مُفعّل</label>
                                        </div>
                                    </td>
                                    <td>
                                        <div class="btn-group" role="group">
                                            <button class="btn btn-sm btn-outline-primary" onclick="editAlert(4)" title="تعديل">
                                                <i class="fas fa-edit"></i>
                                            </button>
                                            <button class="btn btn-sm btn-outline-info" onclick="testAlert(4)" title="اختبار">
                                                <i class="fas fa-vial"></i>
                                            </button>
                                            <button class="btn btn-sm btn-outline-danger" onclick="deleteAlert(4)" title="حذف">
                                                <i class="fas fa-trash"></i>
                                            </button>
                                        </div>
                                    </td>
                                </tr>

                                <!-- تنبيه 5 - معطل -->
                                <tr class="table-secondary">
                                    <td><strong>مدفوعات معلقة</strong></td>
                                    <td><span class="badge bg-primary">مدفوعات</span></td>
                                    <td>أكثر من 48 ساعة</td>
                                    <td>يومياً</td>
                                    <td><span class="badge bg-info">متوسطة</span></td>
                                    <td>-</td>
                                    <td>
                                        <div class="form-check form-switch">
                                            <input class="form-check-input" type="checkbox" id="alert5">
                                            <label class="form-check-label" for="alert5">معطل</label>
                                        </div>
                                    </td>
                                    <td>
                                        <div class="btn-group" role="group">
                                            <button class="btn btn-sm btn-outline-primary" onclick="editAlert(5)" title="تعديل">
                                                <i class="fas fa-edit"></i>
                                            </button>
                                            <button class="btn btn-sm btn-outline-info" onclick="testAlert(5)" title="اختبار">
                                                <i class="fas fa-vial"></i>
                                            </button>
                                            <button class="btn btn-sm btn-outline-danger" onclick="deleteAlert(5)" title="حذف">
                                                <i class="fas fa-trash"></i>
                                            </button>
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- أمثلة التنبيهات -->
            <div class="card mt-4">
                <div class="card-header">
                    <h5 class="mb-0">
                        <i class="fas fa-lightbulb text-primary me-2"></i>
                        أمثلة على التنبيهات المفيدة
                    </h5>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <h6 class="text-primary"><i class="fas fa-clock me-1"></i> تنبيهات الوقت:</h6>
                            <ul>
                                <li>طلبات متأخرة عن الموعد</li>
                                <li>طلبات تقترب من الموعد النهائي</li>
                                <li>مراجعة دورية للطلبات المعلقة</li>
                            </ul>
                        </div>
                        <div class="col-md-6 mb-3">
                            <h6 class="text-success"><i class="fas fa-birthday-cake me-1"></i> تنبيهات العملاء:</h6>
                            <ul>
                                <li>أعياد ميلاد العملاء القادمة</li>
                                <li>عملاء جدد يحتاجون متابعة</li>
                                <li>عملاء غير نشطين لفترة طويلة</li>
                            </ul>
                        </div>
                        <div class="col-md-6 mb-3">
                            <h6 class="text-danger"><i class="fas fa-exclamation-triangle me-1"></i> تنبيهات الأمان:</h6>
                            <ul>
                                <li>تعارضات في الهوية</li>
                                <li>محاولات دخول مشبوهة</li>
                                <li>فشل النسخ الاحتياطي</li>
                            </ul>
                        </div>
                        <div class="col-md-6 mb-3">
                            <h6 class="text-info"><i class="fas fa-cog me-1"></i> تنبيهات النظام:</h6>
                            <ul>
                                <li>مساحة التخزين منخفضة</li>
                                <li>تحديثات النظام المتاحة</li>
                                <li>تقارير الأداء الدورية</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

        </main>

        <!-- Footer -->
        <div class="footer-wrapper">
            <div id="footer-placeholder"></div>
        </div>
    </div>

    <!-- Modals -->
    <div id="modal-placeholder"></div>

    <!-- Bootstrap JS -->
    <script src="assets/js/popper.min.js"></script>
    <script src="assets/js/bootstrap.min.js"></script>
    
    <!-- Custom JS -->
    <script src="assets/js/custom.js"></script>

    <script>
        // تحميل المكونات
        document.addEventListener('DOMContentLoaded', async function() {
            await Promise.all([
                fetch('components/header.html').then(r => r.text()).then(html => {
                    document.getElementById('header-placeholder').innerHTML = html;
                }),
                fetch('components/sidebar.html').then(r => r.text()).then(html => {
                    document.getElementById('sidebar-placeholder').innerHTML = html;
                }),
                fetch('components/footer.html').then(r => r.text()).then(html => {
                    document.getElementById('footer-placeholder').innerHTML = html;
                }),
                fetch('components/confirm-modal.html').then(r => r.text()).then(html => {
                    document.getElementById('modal-placeholder').innerHTML = html;
                })
            ]);
        });

        // تحديث شروط التنبيه حسب النوع
        function updateAlertConditions() {
            const alertType = document.getElementById('alertType').value;
            const conditionSelect = document.getElementById('alertCondition');
            
            // يمكن تخصيص الشروط حسب نوع التنبيه
            console.log('تحديث الشروط لنوع:', alertType);
        }

        // إنشاء تنبيه جديد
        function createAlert(event) {
            event.preventDefault();

            showConfirm(
                'إنشاء تنبيه ذكي',
                'هل تريد إنشاء هذا التنبيه الذكي؟ سيبدأ العمل فوراً حسب التكرار المحدد.',
                'success',
                function() {
                    showSuccess('تم إنشاء التنبيه بنجاح!');
                    document.getElementById('alertForm').reset();
                }
            );

            return false;
        }

        // تعديل تنبيه
        function editAlert(id) {
            showSuccess(`جارٍ فتح نموذج تعديل التنبيه رقم ${id}...`);
        }

        // اختبار تنبيه
        function testAlert(id) {
            showConfirm(
                'إرسال تنبيه تجريبي',
                'هل تريد إرسال تنبيه تجريبي؟ سيتم إرساله فوراً للمستلمين المحددين.',
                'primary',
                function() {
                    showSuccess('تم إرسال التنبيه التجريبي بنجاح! تحقق من صندوق الإشعارات.');
                }
            );
        }

        // حذف تنبيه
        function deleteAlert(id) {
            showConfirm(
                'حذف تنبيه',
                'هل أنت متأكد من حذف هذا التنبيه؟ لن تتمكن من استعادته.',
                'danger',
                function() {
                    showSuccess(`تم حذف التنبيه رقم ${id} بنجاح.`);
                }
            );
        }

        // تفعيل جميع التنبيهات
        function enableAllAlerts() {
            showConfirm(
                'تفعيل جميع التنبيهات',
                'هل تريد تفعيل جميع التنبيهات؟',
                'success',
                function() {
                    const checkboxes = document.querySelectorAll('#alertsTable input[type="checkbox"]');
                    checkboxes.forEach(cb => cb.checked = true);
                    showSuccess('تم تفعيل جميع التنبيهات بنجاح!');
                }
            );
        }

        // تعطيل جميع التنبيهات
        function disableAllAlerts() {
            showConfirm(
                'تعطيل جميع التنبيهات',
                'تحذير: هل أنت متأكد من تعطيل جميع التنبيهات؟ لن تستلم أي إشعارات تلقائية.',
                'danger',
                function() {
                    const checkboxes = document.querySelectorAll('#alertsTable input[type="checkbox"]');
                    checkboxes.forEach(cb => cb.checked = false);
                    showSuccess('تم تعطيل جميع التنبيهات.');
                }
            );
        }
    </script>
</body>
</html>

